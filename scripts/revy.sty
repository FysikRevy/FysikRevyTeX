%%
%% This is file `ucph-script.cls',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% ucph-script.dtx  (with options: `class')
%% This is a generated file.
%% 
%% Copyright (C) hyear i by hyour namei
%% 
%% This file may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License, either
%% version 1.3 of this license or (at your option) any later
%% version. The latest version of this license is in:
%% 
%% http://www.latex-project.org/lppl.txt
%% 
%% and version 1.3 or later is part of all distributions of
%% LaTeX version 2005/12/01 or later.
\newif\if@thumbindex\@thumbindexfalse
\RequirePackage{xstring}
\DeclareOption{thumbindex}{\@thumbindextrue}
\newcommand{\planfile}{aktoversigt.plan}
\DeclareOption*{
  \begingroup
  \IfBeginWith{\CurrentOption}{planfile=}{
    % \catcode`\_=12\relax
    \def\planfile#1=#2{#2}
    \xdef\planfile{\expandafter\planfile\CurrentOption}
    % \catcode`\_=8\relax
  }{
    \PackageWarning{revy}{Unknown option '\CurrentOption', ignored}
  }
  \endgroup
}
\DeclareOption{thumbindex}{\@thumbindextrue}
\ProcessOptions\relax
\setlength{\topmargin}{0cm}
\setlength{\voffset}{-1cm}
\addtolength{\textheight}{4cm}
\RequirePackage{varwidth}
\def\maketitle{{\thispagestyle{empty}
    \vspace*{-\headheight}\vspace*{-\headsep}
    \centering{\Large\@revyname{} \@revyyear}\vspace{5pt}\\
    {\LARGE \bf \@title}\vspace{5pt}\\
    \if@author{\large\@writtenbyname{} \@author}\vspace{5pt}\\\fi
    \if@melody{\sl\@melodyname{} \@melody}\vspace{5pt}\\\fi
    \if@leftfields
      \begin{varwidth}[t]{\bigheaderwidth}\raggedleft
        \if@status{\@statustext{} \@status}\vspace{2pt}\\\fi
        \if@responsible{\@responsibletext{} \@responsible}\vspace{2pt}\\\fi
        \if@eta{(\@eta)}\\\fi
      \end{varwidth}%
      \ \hspace{.5em}\vrule{}\hspace{.5em}
      \begin{varwidth}[t]{\smallheaderwidth}\raggedright
        Version \@version\vspace{2pt}\\
        \today\vspace{2pt}\\
        \pagessum{\getpagerefnumber{lastpage}}
      \end{varwidth}
    \else
      Version \@version
      \ \hspace{.5em}\vrule\hspace{.5em}
      \today
      \ \hspace{.5em}\vrule\hspace{.5em}
      \pagessum{\getpagerefnumber{lastpage}}
    \fi
\vskip 5pt}}
\RequirePackage{refcount}
\def\if@leftfields{
  \def\@responsiblenum{\ifx\iftrue\if@responsible 1 \else 0 \fi}
  \def\@statusnum{\ifx\iftrue\if@status 1 \else 0 \fi}
  \def\@etanum{\ifx\iftrue\if@status 1 \else 0 \fi}

  \ifnum1=\ifnum1=\@responsiblenum 1
  \else \ifnum1=\@statusnum 1
  \else \ifnum1=\@etanum 1
  \else 0
  \fi\fi\fi
}
\newlength{\smallheaderwidth}
\setlength{\smallheaderwidth}{22ex}
\newlength{\bigheaderwidth}
\setlength{\bigheaderwidth}{\textwidth}
\addtolength{\bigheaderwidth}{-\smallheaderwidth}
\addtolength{\bigheaderwidth}{-1.5em}
\def\version#1{\def\@version{#1}}
\def\@version{\@ifundefined{the@version}
{\typein[\versionsnr]{Indtast revytekstens versionsnummer: }%
\global\let\the@version=\versionsnr}{}\the@version}

\def\@title{En sketch}

\def\@revyname{DIKUrevy}
\def\revyname#1{\def\@revyname{#1}}
\def\@revyyear{1973}
\def\revyyear#1{\def\@revyyear{#1}}
\newif\if@status\@statusfalse
\def\status#1{\def\@status{#1}\@statustrue}
\def\@status{}
\def\@statustext{Status:}
\def\statustext#1{\def\@statustext{#1}}
\newif\if@eta\@etafalse
\def\eta#1{\def\@eta{#1}\@etatrue}
\def\@eta{}

\newif\if@responsible\@responsiblefalse
\def\responsible#1{\def\@responsible{#1}\@responsibletrue}
\def\@responsible{}
\def\@responsibletext{\TeX--ansvarlig:}
\def\responsibletext#1{\def\@responsibletext{#1}}
\newif\if@melody\@melodyfalse
\def\melody#1{\def\@melody{#1}\@melodytrue}
\def\@melody{}
\def\@melodyname{Melodi:}
\def\melodyname#1{\def\@melodyname{#1}}

\newif\if@author\@authorfalse
\def\author#1{\def\@author{#1}\@authortrue}
\def\@author{}
\def\@writtenbyname{skrevet af}
\def\writtenbyname#1{\def\@writtenbyname{#1}}
\def\auteurs#1{\def\@author{#1}\@authortrue}
\newcommand{\pagessum}[1]{#1 side\ifnum1=#1\else r\fi}
\gdef\ps@revyheadings{
  \def\@oddhead{\vbox to 0pt{\vss
      \hbox to \textwidth{\hfil\rectoheaderthumbtab}
      \hbox{\rm\strut\@revyname{} \@revyyear}
      \hbox to \textwidth{Version \@version\quad\today
        \hfil {\large\sl\@title}\hfil
        Side \rm\thepage/\pageref{lastpage}}
      \hrule}}
  \def\@evenhead{\vbox to 0pt{\vss
      \hbox{\versoheaderthumbtab}
      \hbox to \textwidth{\hfil\rm\strut\@revyname{} \@revyyear}
      \hbox to \textwidth{Side \rm\thepage/\pageref{lastpage}
        \hfil {\large\sl\@title}\hfil
        Version \@version\quad\today}
      \hrule}}
  \def\@oddfoot{}\def\@evenfoot{}}
\pagestyle{revyheadings}
\gdef\ps@empty{
  \def\@oddhead{\vbox to 0pt{\vss
      \hbox to \textwidth {\hfil\rectoheaderthumbtab }
      \vbox to 2em{}}}
  \def\@evenhead{\vbox to 0pt{\vss\hbox{\versoheaderthumbtab}}}
  \def\@oddfoot{}\def\@evenfoot{}}
\newcommand{\versoheaderthumbtab}{}
\newcommand{\rectoheaderthumbtab}{}
\newenvironment{roles}{{\bigskip\noindent\Large\bf\@rolename}
                       \begin{list}{}{
                       \labelwidth 8em
                       \leftmargin 10em
                       \rightmargin 0em
                       \labelsep 1em
                       \listparindent 0em
                       \topsep 1ex
                       \partopsep 0ex
                       \parsep 1ex
                       \itemsep -1ex\relax}}{
                       \end{list}\smallskip\hfil\rule{6cm}{0.1mm}\medskip\par}
\def\@role#1{\item [{\bf #1} \hfill] }
\def\@roleas#1[#2]{\item [{\bf #1} (#2) \hfill] }
\def\role#1{\@ifnextchar [{\@roleas{#1}}{\@role{#1}}}
\def\@rolename{Roller:}
\def\rolename#1{\def\rolename{#1}}
\newenvironment{props}{{\smallskip\noindent\Large\bf\@propname}
                       \begin{list}{}{
                       \labelwidth 8em
                       \leftmargin 10em
                       \rightmargin 0em
                       \labelsep 1em
                       \listparindent 0em
                       \topsep 1ex
                       \partopsep 0ex
                       \parsep 1ex
                       \itemsep -1ex\relax}}
                       {\end{list}\smallskip\hfil\rule{6cm}{0.1mm}\medskip\par}
\let\prop=\role
\def\@propname{Rekvisitter:}
\def\propname#1{\def\propname{#1}}
\newdimen\sketchleftmargin
\sketchleftmargin 3em
\newenvironment{sketch}{\rm\begin{list}{}{
                        \labelwidth 2em
                        \leftmargin \sketchleftmargin
                        \rightmargin 0em
                        \labelsep 0.5em
                        \listparindent 2em
                        \topsep 1ex
                        \partopsep 1ex
                        \parsep 0ex
                        \itemsep 1ex\relax}\item \rule{0.2em}
                          {0em}\vspace{-1em}\par}{
                        \end{list}}
\def\says#1{\@ifnextchar [{\@saysas{#1}}{\@says{#1}}}
\def\@saysas#1[#2]{\rm\item [{\bf #1 }{\it (#2)\,}\hfill:]}
\def\@says#1{\rm\item [{\bf #1\,}\hfill:]}
\def\act#1{{\it(#1)\/}}
\def\scene{\medskip\par\it\noindent\relax}
\newdimen\songleftmargin
\newdimen\songhangindent
\newskip\songparskip
\songleftmargin 7em
\songhangindent 2em
\songparskip.6\baselineskip
\newenvironment{song}{\rm\begin{list}{}{\raggedright
                        \labelwidth 4.5em
                        \leftmargin \songleftmargin
                        \rightmargin 0em
                        \labelsep 2.5em
                        \listparindent -\songhangindent
                        \topsep 0ex
                        \partopsep \bigskipamount
                        \parsep \songparskip
                        \itemsep -\songparskip
                        \relax}\item[]
   \rule{0.2em}{0em}\vspace{-\baselineskip}\strut\par
\tolerance10000\hfuzz21cm\obeycr}{\end{list}}
\newif\if@newpar
\def\lin@break{\if@newpar\par\else\\\fi\@newparfalse}
\def\linebr@ak{\if@newpar\bigskip\par\fi\@newparfalse}
{\catcode`\^^M=13 \gdef\@carriagereturn{\@ifnextchar^^M%
  {\@newpartrue}{\@ifnextchar\end{}{\@ifnextchar\sings{\linebr@ak}{\lin@break}}}}%
  \gdef\obeycr{\catcode`\^^M=13 \let^^M=\@carriagereturn\@gobblecr}%
  \gdef\restorecr{\catcode`\^^M=5 }}
\def\sings#1{\@ifnextchar [{\@singsas{#1}}{\@sings{#1}}} %}
\def\@singsas#1[#2]{\rm\item [\hskip\@leftsingpad{\bf #1 }{\it
  (#2)\,}:\hskip\@rightsingpad]\hskip-\songhangindent}
\def\@sings#1{\rm\item [\hskip\@leftsingpad{\bf #1\,}:\hskip
  \@rightsingpad]\hskip-\songhangindent}
\newskip\@leftsingpad
\newskip\@rightsingpad
\def\flushsingsright{\@leftsingpad 0pt plus 1fill\@rightsingpad 0pt\relax}
\def\flushsingsleft{\@leftsingpad 0pt\@rightsingpad 0pt plus 1fill\relax}
\flushsingsleft
\if@thumbindex
  \expandafter\@firstofone
\else
  \expandafter\@gobble
\fi{
  \RequirePackage{tikz}
  \begingroup
  \def\expandFiHere#1\fi{\fi #1}
  \def\patheat#1/#2{%
    \ifx\relax#2\else
      \expandFiHere#1/\patheat#2%
    \fi
  }
  \edef\planpath{\expandafter\patheat\planfile/\relax}
  \def\titleeater#1#2\title#3{%
    \ifx\done#3%
      #1%
    \else
      \expandFiHere
      \titleeater{#3}%
    \fi
  }
  \let\text\relax
  \count256=0
  \endlinechar=-1
  \newtoks\tabtoks
  \newread\tabtex
  \newread\planread
  \openin\planread=\planfile
  \loop\ifeof\planread
    \closein\planread
  \else
    \ifeof\tabtex
      \let\readline\empty
      \read\planread to \line
      \expandafter\ifx\expandafter\par\line\else
        \IfEndWith{\line}{.tex}{
          \advance\count256 by 1
          \openin\tabtex=\planpath\line
        }{%
          \edef\act{\noexpand\tabtoks={%
            \the\tabtoks
            \noexpand\undertab
            \number\count256
            \noexpand\text
            \line
            \noexpand\stop
          }}\act
        }
      \fi
    \else
      \read\tabtex to \subline
      \edef\readline{%
        \expandafter\titleeater
        \expandafter\readline\subline\title\done
      }
      \ifeof\tabtex
        \edef\act{\noexpand\tabtoks={%
            \the\tabtoks
            \noexpand\overtab
            \number\count256
            \noexpand\text
            \readline
            \noexpand\stop
          }}\act
      \fi
    \fi
  \repeat
  \edef\act{\noexpand\tabtoks={%
      \the\tabtoks
      \noexpand\undertab
      \number\count256
      \noexpand\text
      \noexpand\done
      \noexpand\stop
    }}\act
  \closein\tabtex
  \xdef\revy@tabs{\the\tabtoks}
  \gdef\revy@tabscontext{%
    \def\expandFiHere##1\fi{\fi ##1}
    \dimendef\tabheight=256
    \tabheight = \paperheight
    \advance\tabheight by -1cm%
    \def\undertab##1\text##2\stop{
      \ifx\done##2%
        \divide\tabheight by ##1%
      \fi
    }
    \def\overtab##1\text##2\stop{}%
    \revy@tabs
    \newif\ifwritetitles\writetitlesfalse
    \def\printovertab##1##2{
      \fill ( 0, -##1\tabheight )
            node[ text=white, anchor=east ]{\bfseries##1}
            +( \overtableft, -.5\tabheight + 1mm )
            rectangle +( \overtabright, .5\tabheight - 1mm )
            +( \textoffset, 0 )
            \ifwritetitles
              node[ anchor=\textanchorcorner,
 %                   text width=30em,
 %                   align=\textside
                  ]{\small\bfseries##2}
            \fi
            ;
    }%
    \def\printundertab##1##2##3{%
      \path ( 0, -##1\tabheight ) +( \undertabright, -.5\tabheight - 1mm )
            coordinate (topright);
      \path ( 0, -##2\tabheight ) +( \undertableft, -.5\tabheight + 1mm )
            coordinate (bottomleft);
      \fill[ color=black!30 ] (topright) rectangle (bottomleft);
      \path (bottomleft)
            \underangle node[ xshift=\undersign.5cm,
                              pos=\underpos,
                              rotate=\undersign90
                            ]{\Large##3}
            (topright);
      }%
    \def\overtableft{-1cm}
    \def\overtabright{1cm}
    \def\undertabright{\overtabright}
    \def\undertableft{\overtableft - 1cm}
    \def\underangle{|-}
    \def\underpos{.25}
    \def\undersign{}
    \def\textanchorcorner{east}
    \def\textoffset{\undertableft - .5cm}
    \def\textside{right}
    \def\movetoleftside{
      \def\overtableft{-1.8cm}
      \def\overtabright{.2cm}
      \def\undertabright{\overtabright + 1cm}
      \def\undertableft{\overtableft}
      \def\underangle{-|}
      \def\undersign{-}
      \def\underpos{.75}
      \def\textanchorcorner{west}
      \def\textoffset{\undertabright + .5cm}
      \def\textside{left}
    }
    \def\overtab##1\text##2\stop{%
      \printovertab{##1}{##2}
    }
    \def\undertab##1\text##2\stop{
      \ifx\done##2\else
        \let\undertab\undertabspan
        \expandFiHere
        \undertab##1\text##2\stop
      \fi
    }
    \def\undertabspan##1\text##2\stop##3\undertab##4\text##5\stop{%
      \printundertab{##1}{##4}{##2}%
      ##3%
      \ifx\done##5\else
        \expandFiHere
        \undertab##4\text##5\stop
      \fi
    }%
    \def\filtername##1{
      \def\doWhenMatch{}
      \def\overtab####1\text####2\stop{
        \IfStrEq{##1}{####2}{
          \doWhenMatch
          \printovertab{####1}{####2}
        }{}
      }
      \def\undertabspan####1\text####2\stop####3\undertab####4\text####5\stop{
        \def\doWhenMatch{
          \printundertab{####1}{####4}{####2}
          \def\doWhenMatch{}
        }

        ####3
        \ifx\done####5\else
          \expandFiHere
          \undertab####4\text####5\stop
        \fi
      }
    }
    \def\strut{
      \path (0, 0) -- (0, -\paperheight + .5cm);
    }
    \def\print{
      \begin{tikzpicture}
        \revy@tabs
        \strut
      \end{tikzpicture}
    }
  }
  \endgroup
  \newcommand{\rectothumbindex}{
    \begingroup
    \revy@tabscontext
    \print
    \endgroup
  }
  \newcommand{\rectothumbindexwithtitles}{
    \begingroup
    \revy@tabscontext
    \writetitlestrue
    \print
    \endgroup
  }
  \newcommand{\rectothumbtabfor}[1]{
    \begingroup
    \revy@tabscontext
    \filtername{#1}
    \print
    \endgroup
  }
  \newcommand{\rectothumbtabwithtitlefor}[1]{
    \begingroup
    \revy@tabscontext
    \filtername{#1}
    \writetitlestrue
    \print
    \endgroup
  }
  \newcommand{\versothumbindex}{
    \begingroup
    \revy@tabscontext
    \movetoleftside
    \print
    \endgroup
  }
  \newcommand{\versothumbindexwithtitles}{
    \begingroup
    \revy@tabscontext
    \movetoleftside
    \writetitlestrue
    \print
    \endgroup
  }
  \newcommand{\versothumbtabfor}[1]{
    \begingroup
    \revy@tabscontext
    \movetoleftside
    \filtername{#1}
    \print
    \endgroup
  }
  \newcommand{\versothumbtabwithtitlefor}[1]{
    \begingroup
    \revy@tabscontext
    \movetoleftside
    \filtername{#1}
    \writetitlestrue
    \print
    \endgroup
  }
  \renewcommand{\rectoheaderthumbtab}{
    \rectothumbtabfor{\@title}%
    \vspace*{ -\paperheight }\vspace*{ -\voffset }\vspace*{ 0.32in }%
    \hspace{-\paperwidth }\hspace{ 1in }\hspace{ \oddsidemargin }%
    \hspace{ \hoffset }\hspace{ \textwidth }\hspace{-.6cm}%
  }
  \renewcommand{\versoheaderthumbtab}{
    \hspace{ -2.5in }\hspace{ -\evensidemargin }%
    \hspace{ -\hoffset }\hspace{ -1in }%
    \versothumbtabfor{\@title}%
    \vspace*{ -\paperheight }\vspace*{ -\voffset }\vspace*{ 0.32in }%
  }
}
\let\revyinfo=\relax
\newtoks\@titletoks
\newtoks\@authortoks
\newtoks\@melodytoks
\newtoks\@revyrevynametoks
\newtoks\@revyrevyyeartoks
\let\end@document=\enddocument
\def\enddocument{\label{lastpage}\write\@auxout
  {\string\@ifundefined{revyinfo}{\string\def\string
  \revyinfo\string##1\string##2\string##3\string
  ##4\string##5\string##6\string##7\string##8{}}{}}\@titletoks=
  \expandafter{\@title}\@titletoks=
  \expandafter{\@title}\@authortoks=
  \expandafter{\@author}\@melodytoks=
  \expandafter{\@melody}\@revyrevynametoks=
  \expandafter{\@revyname}\@revyrevyyeartoks=
  \expandafter{\@revyyear}\write\@auxout
  {\string\revyinfo{\the\@titletoks}{\@version}
    {\today}%
    {\the\@authortoks}%
    {\the\@melodytoks}%
    {}%
    {\the\@revyrevynametoks}%
    {\the\@revyrevyyeartoks}%
  }%
  \end@document
}
\endinput
%%
%% End of file `ucph-script.cls'.
